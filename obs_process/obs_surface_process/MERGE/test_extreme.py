from netCDF4 import Dataset
import matplotlib.pyplot as plt
import numpy as np
import os
from netCDF4 import num2date, date2num

species = os.getcwd().split('/')[-2]

bad =  ['abat2ka71','abat2kl17','abat2m226','abat2sv24','abat2vk26','abat30402','abat30406','abat30603','abat30901','abat30992','abat4s184','abat4s401','abat4s406','abat4s412','abat4s413','abat4s414','abat60103','abat60104','abat60106','abat60114','abat60115','abat60119','abat60139','abat60140','abat60141','abat60145','abat60160','abat60161','abat60162','abat60172','abat60197','abat72126','abat82707','abba0034a','abba0035a',
        'abbg0019a','abbg0056a','abbg0057a','abbg0058a','abbg0074a','abch0023a','abch0036a','abch0040a','abch0041a','abcz0asan','abcz0ljnm','abcz0molj','abcz0molo','abcz0skls','abcz0tovk','abcz0tozr','abcz0uchm','abcz0udcm','abdebb016','abdebb037','abdeby009','abdeby067','abdeby069','abdehe002','abdehh054','abdeni026','abdenw066','abderp042','abdest006','abdeth012','abdeth017','abee0021a','abes1180a','abes1364a', 'abes1400a','abes1538a','abes1851a','abfr0037a','abfr02005','abfr02037','abfr03014','abfr03038','abfr03047','abfr03062','abfr03066','abfr05070','abfr06018','abfr07002','abfr07003','abfr07035','abfr08003','abfr08711','abfr10007','abfr10014','abfr10016','abfr10026','abfr10041','abfr1054a','abfr1056a','abfr12003','abfr1250a','abfr13007','abfr14003','abfr14005','abfr14006','abfr14007','abfr14012','abfr15002','abfr15007','abfr16054','abfr16056','abfr16057','abfr18053','abfr22004','abfr22016','abfr23058','abfr23065','abfr23093','abfr23174','abfr23179','abfr23188','abfr24030','abfr25028','abfr25048','abfr26003','abfr26006','abfr27001','abfr28001','abfr28003','abfr28011','abfr28131','abfr32014','abfr33305','abfr41001','abgb0036r','abgb0040r','abgb0051a','abgb0962a','abgr0033a','abgr0042a','abgr0110r','abie0132a','abit0440a','abit0441a','abit0447a','abit0558a','abit0659a','abit0663a','abit0684a',                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        'abit0692a','abit0709a','abit0782a','abit0838a','abit0862a','abit0906a','abit0982a','abit1042a','abit1061a','abit1065a','abit1103a','abit1156a','abit1222a','abit1225a','abit1238a','abit1292a','abit1328a','abit1340a','abit1439a','abit1459a','abit1468a','abit1557a','abit1571a','abit1670a','abit1725a','abit1845a','abit1868a','abit1919a',                                                                                                                                             
        'abit1925a','abit1944a','abit2032a','abit2051a','ablt00001','ablt00012','ablt0021a','abmk0030a','abmk0048a','abnl00107','abnl00442','abno0075a','abpl0011a','abpl0021a','abpl0033a','abpl0039a','abpl0043a','abpl0051a','abpl0126a','abpl0115a','abpl0119a','abpl0122a','abpl0126a','abpl0134a','abpl0136a','abpl0144a','abpl0148a','abpl0162a','abpl0198a','abpl0221a','abpl0256a','abpl0276a','abpl0321a','abpt03101','abpt03103','abro0074a','abro0075a','abro0077a','abro0079a','abro0084a','abro0191a','abro0208a','abrs0030a','abrs0031a','abrs0033a','abrs0034a','abrs0039a','abrs0040a','abrs0043a','abrs0044a','abrs0045a','abrs0046a','abrs0048a','abse0053a','absk0003a','absk0004a','absk0008a','absk0015a','absk0028a','absk0047a','absk0051a','absk0267a','aqs060290011','aqs060651016','aqs180830004','aqs181290001','aqs320030007','aqs400219002','aqs400719003','aqs420110001','canaps051802','canaps060807','canaps061004','canaps065001','canaps090402','canaps090601','canaps101101','canaps101701','canaps103205','canaps104003','canaps104003','canaps104301','bsc','bur','car','log','pld','plv','sof','vrn',
        'abat60180','abbg0071a','abes1811a','abfr01014','abfr03032','abfr07038','abfr12052','abfr14022','abfr14042','abfr14051','abfr15018','abfr17016','abfr19010','abfr19015','abfr20061','abfr24033','abfr26019','abfr29439','abfr36019','abfr37003','abfr39007','abfr39008','abfr39009','abit0824a','aqs320030023','canaps040302','canaps060809','canaps092901','canaps101501','canaps102401','canaps102701','aqs291830008','ablv0rim1','abse0054a','abse0055a',
        'abbg0026a','abbg0038a','abdebb010','abdest074','abdeub020','abfi00066','abfi00424','abfi00582','abfr02026','abfr05086','abfr06134','abfr08401','abfr12053','abfr15001','abfr18049','abfr22022','abfr23181','abfr23182','abfr34034','abfr34046','abfr41002','abgb0929a','abgb0995a','abgb0999a','abgb1005a','abgr0120a','abie0140a','abit1307a','abit1663a','abit1729a','abit2054a','abpl0151a','abpl0152a','abpl0187a','abpl0210a','abro0126a','abse0030a','abse0080a','absi0033a','absk0031a','aqs050350005','aqs350451233','canaps060610','canaps061104','canaps061201','canaps061802','canaps062001','canaps090502','canaps102102','canaps102801','canaps107100','canaps119004','canaps010401','abit1311a','ch0031r','canaps060602','canaps060806','snl','abis0015a','canaps030201','canaps094301']

good = ['abat0ill1','abat2sp10','abat30102','abat30602','abat31204','abat4s108','abat4s199','abat4s425','abat51002','abat52055','abat60144','abat60147','abat72538','abbelhr01','abbelld02','abbetn015','abbetn016','abbetn027','abbetn046','abbetn054','abbetn063','abbg0070a','abch0002r','abch0003r','abch0024a','abch0033a','abch0037a','abch0045a','abcz0jkos','abcz0sonr','abcz0tbom','abcz0tctn','abcz0tfmi','abcz0thar','abcz0tora','abcz0torv','abcz0tver','abcz0utpm','abcz0uvse','abdebw031','abdeby030','abdehe034','abdehe042','abdehe043','abdehe048','abdeni017','abdeni030','abdenw001','abdenw068','abdenw081','abdesh001','abdeub008','abdeub009','abdk0041a','abes0007r','abes1660a','abes1661a','abfr02015','abfr07015','abfr07037','abfr33220','abgb0754a','abit0267a','abit0741a','abit0842a','abit0988a','abit1174a','abit1187a','abit1188a','abit1210a','abit1214a','abit1233a','abit1288a','abit1339a','abit1418a','abit1464a','abit1553a','abit1595a','abit1736a','abit1791a','abit1812a','abit1914a','abit1917a','abit1924a','abit2063a','abit2071a','ablt00044','abmk0042a','abnl00131','abnl00227','abnl00230','abnl00235','abnl00301','abnl00318','abnl00437','abnl00538','abnl00565','abnl00620','abnl00631','abnl00633','abnl00733','abnl00724','abnl00738','abnl00807','abno0063a','abpl0014a','abpl0024a','abpl0026a','abpl0212a','abpt01048','abpt03091','abpt03092','abro0072a','abro0153a','abro0212a',            
        'aqs040134008','aqs040250005','aqs060250006','aqs060270101','aqs060650008','aqs060651004','aqs060719002','aqs061070005','aqs061070008','aqs061070009','aqs061090006','aqs212270008','aqs250154002','aqs360310005','aqs401010167','aqs420550001','aqs470090101','aqs471550101','aqs540250001','aqs560050011','canaps092001','canaps100315','canaps106800','bwr139','sek402','btw','gah','hun','kmw','kos','man','pay','plm','sdz','tap','ush','zbl','by0004r','cy0002r','de0043g','eahe275','easa209','eata187','eayu264','ee0009r','es0005r','es0007r','fr0013r','gb0015r','gb0033r','gb0038r','gb0043r','gb0050r','gb0051r','gr0002r','it0004r','nl0007r','nl0091r','no0045r','ro0008r','ru0014r',
        'abat0zil1','abat31496','abat4s407','abat60154','abbetn073','abdeub012','abes1436a','abfr10029','abfr15045','abfr16017','abfr20068','abfr21031','abfr28022','abfr30030','abfr30037','abfr35001','abit0774a','abit1179a','abit1212a','abit1245a','abit1451a','abit1522a','abit1596a','abit1619a','abit1762a','abit1831a','abit1861a','abit1865a','abit1870a','abit1912a','abit1915a','abit1921a','abit1960a','abit2014a','abit2072a','abli0001a','abnl00232','abnl00245','abnl00444','abnl00722','abnl00918','abnl00928','abno0080a','abpt01044','abpt01054' ,'aqs040270006','aqs060390004','aqs060470003','aqs060675002','aqs060773003','aqs060794001','aqs060831020','aqs181410012','aqs212130004','aqs320030022','aqs320030078','aqs320031019','aqs400310647','aqs471050003','aqs471250009','aqs550591001','aqs560050892','dk0041r','nl0011r','canaps090701','canaps093202','canaps101401',
        'abfr21004','abfr23096','abfr23097','abfr27101','abgb0920a','abit1312a','abit1948a','abnl00246','abnl00247','abpl0238a','abpl0273a','absk0017a','absk0030a','aqs060290007','aqs181291002','aqs181550001','aqs181631001','aqs181631002','aqs181671012','aqs210150006','aqs210150007','aqs220470002' ,'aqs220930002','aqs261470904','aqs391291001','aqs471131001','aqs540990003','aqs551051002','aqs551051004','nl0002r','nl0010r','nl0644r','roq','ablv000d1','ablv000o1','ablv000v1','ablv00ng1','abro0060a','ch0002r','ch0005r','cvo','hpb','rig_photo','ssl','searchctr','searchoak','searchyrk','abat0vor1','abbetn085','abbetn132','abch0004r','abch0005r','abdk0012r','abee0009r','abee0022a','abes1489a','abes1599a','abes1883a','abnl00644','abpl0030a','abro0082a','abro0087a','abro0206a','aqs090050005','aqs230090103','aqs240190004','aqs240230002','aqs330115001','aqs391351001','aqs400019009','aqs550270001','de0003r','nl0009r','bal','bkt','cri','egb','goz','itn','kzd','ngl','oxk','rig','ryo','scs918n','scs921n','uum','yon',
        'abes0006r','abes0012r','abes0015r','abes1200a','abes1441a','abes1754a','abes1802a','abes1854a','abes1898a','abes1996a','abfr03027','abfr24014','abfr30028','abfr31027','abfr41024','abit1672a','abit1758a','abit1848a','abit2027a','abit2103a','abmt00007','abpl0058a','abpl0186a','abpt05012','abrs0005r','absi0053a','absk0042a','aqs040190021','aqs060070007','aqs060295001','aqs060390500','aqs060659002','aqs060798005','aqs060831019','aqs060831025','aqs060831030','aqs060834004','aqs061110005','aqs061110006','aqs320038000','aqs350281002','aqs400190297','aqs400670671','aqs400770440','aqs460330132','aqs480430101','aqs490472003','aqs490530130','aqs511130003','aqs560130232','bbe401','nec602','pnf126','sek430','shn418','vpi120','eaok242','eari165','at0032r','at0040r','ch0004r','dk0009r','es0001r','es0006r','es0010r','es0012r','fr0012r','fr0030r','cas','glh','mhn','puy',  
        'abat0enk1','abat0hbg1','abat0pil1','abat10002','abat2wo35','abat30103','abat30202','abat30302','abat30403','abat30407','abat31701','abat31703','abat31902','abat31903','abat31904','abat31905','abat31906','abat32201','abat32604','abat60105','abat60127','abat60151','abbetn029','abbetn093','abbetn100','abch0019a','abch0051a','abcz0bmis','abcz0esvr','abcz0htrm','abcz0jkmy','abcz0jtre','abcz0kchm','abcz0knal','abcz0lbli','abcz0lclm','abcz0lsou','abcz0mbup','abcz0ppls','abcz0sdub','abcz0tstd','abcz0ttrk','abcz0ukru','abcz0ulom','abcz0umed','abcz0urvh','abcz0usnz','abcz0utus','abcz0uval','abcz0zsnv','abdebb051','abdebw103','abdeby013','abdeby047','abdeby049','abdeby072','abdeby081','abdeby092','abdeby109','abdeby124','abdehe023','abdehe024','abdehe025','abdehe026','abdehe027','abdehe028','abdehe039','abdehe046','abdehe050','abdehe052','abdemv001','abdemv004','abdemv017','abdeni014','abdeni019','abdeni058','abdeni059','abdeni060','abdeni063','abdenw063','abdenw065','abderp013','abderp014','abderp015','abderp016','abderp017','abderp028','abdesh008','abdesl008','abdesl019','abdesn052','abdesn057','abdesn074','abdesn076','abdesn079','abdesn093','abdest067','abdest069','abdest104','abdeub002','abdeub005','abdeub006','abdeub007','abdeub013','abdeub017','abdeub018','abdeub019','abdeub021','abdeub022','abdeub023','abdeub024','abdeub025','abdeub027', 
        'abdeub032','abdeub033','abdeub034','abdeub035','abdeub036','abdeub038','abdeub042','abes0297a','abes1491a','abes1614a','abes1774a','abes1805a','abes1831a','abes1853a','abes1923a','abfi00431','abfr01004','abfr04038','abfr04328','abfr05053','abfr16031','abfr22017','abfr23124','abfr30029','abfr30033','abfr33302','abfr38011','abfr38012','abfr38014','abfr41007','abfr41017','abgb0045r','abgb0737a','abhu0040a','abie0091a','abit1085a','abit1121a','abit1425a','abit1519a','abit1542a','abit1665a','abit1666a','abit1823a','abit1832a','abit1902a','abit1904a','abit1911a','ablu0103a','ablu0104a','ablu0105a','abnl00818','abnl00913','abnl00929','abpl0027a','abpl0046a','abpl0068a','abpl0091a','abpl0094a','abpl0105a','abpl0243a','abpl0247a','abpt01051','abpt02022','abpt03099','abro0138a','abro0210a','absi0054a','absk0013a','absk0027a','absk0134a','absk0263a','abhu0019a','aqs040134011','aqs060131002','aqs060530005','aqs060670011','aqs060711234','aqs060830008','aqs060831015','aqs060831017','aqs060831018','aqs060831027','aqs120570081','aqs160210003','aqs160390002','aqs160550003','aqs160770011','aqs171050002','aqs171971011','aqs180510010','aqs180730002','aqs180730003','aqs181090004','aqs181270015','aqs181270016','aqs181470002','aqs181470006','aqs181530001','aqs181830003','aqs191630014','aqs210470006','aqs211770005','aqs212230004','aqs220110002','aqs220190007',
        'aqs220190008','aqs220190009','aqs220331001','aqs220470006','aqs220470007','aqs220470009','aqs220470012','aqs220770001','aqs260630905','aqs261110941','aqs261470905','aqs261590901','aqs271710007','aqs290470005','aqs291830010','aqs330150013','aqs350130022','aqs401159004','aqs420270100','aqs420630004','aqs420990301','aqs421255001','aqs470430009','aqs470630003','aqs471131003','aqs471190106','aqs481210034','aqs481390017','aqs481830001','aqs484390075','aqs510330001','aqs550170001','aqs550350010','aqs551051005','eaka418' ,'be0001r','be0013r','be0032r','be0035r','dk0012r','es0003r','es0004r','fr0015r','gb0036r','gb0037r','gb0045r','gr0001r','it0001r','ivn','ktb','canaps051501','canaps054703','canaps062401','canaps062601','canaps062701','canaps065401','canaps070203','canaps090602','canaps090606','canaps090702','canaps090801','canaps090806','canaps090901','canaps091601','canaps093801','canaps094201','canaps094202','canaps101601','canaps103502','canaps104803','canaps105001','canaps105301',
        'abat0sto1','abat2f101','abee0011r','abee0016a','abes0001r','abes0005r','abes1531a','abes1671a','abes1778a','abes1990a','abes1991a','abfi00352','abfi00356','abfi00372','abgb0015r','abit2011a','abpl0150a','abpl0313a','abpt01047','abpt07001','abse0066a','absk0004r','abhu0017a','aqs060231005','aqs060831014','aqs060834003','aqs060835001','aqs261130001','aqs270750005','aqs300270006','aqs300650004','aqs300710010','aqs300750001','aqs300830001','aqs300870001','aqs300870760','aqs300870762','aqs380130004','aqs380250003','aqs380530002','aqs380570101','aqs380650002','aqs380910001','aqs421174000','aqs450791006','aqs460710001','aqs470550001','aqs550410007','canaps030701','canaps030901','canaps031001','canaps041302','canaps091701','canaps091801','canaps094401','canaps101803','canaps129102','aqs560050123','es0009r','es0011r','es0013r','es0015r','fi0037r','fi0096g','gb0002r','aht','abdenw093','abit1726a','aqs060731011','aqs191530024','aqs240010012','aqs530531010','ncs415','oly421','eata308','no0044r','dmv','lau','mbi','smo','canaps093501',
        'abes1616a','abro0086a','abp','ams','asc','bhd','cfa','cgo','chr','cpt','crz','cya','eic','gmi','hba','maa','mqa','nat','nmb','poc900n','poc905n','poc905s','poc910n','poc910s','poc915n','poc915s','poc920s','poc925s','poc930s','poc935s','psa','rpb','sey','syo','tdf',
        'abat0zoe2','abat30502','abat31502','abat53055','abat60137','abat60156','abat60185','abat80503','abba0001g','abcz0cchu','abcz0chvo','abcz0hkry','abcz0hser','abcz0kprb','abcz0lfru','abcz0mjes','abcz0pprm','abcz0tbkr','abdebb053','abdebb065','abdebb066','abdebw087','abdeby122','abdehe051','abdehe060','abdemv012','abdemv024','abdeni051','abdeni077','abdenw064','abdest039','abdest070','abdest089','abdeth027','abdeth040','abdeth042','abdeth061','abdeub001','abdeub003','abdeub004','abdeub026','abdeub028','abdeub029','abdeub030','abdeub031','abdeub039','abdeub040','abdeub041','abdk0031r','abdk0048a','abdk0054a','abes0008r','abes0009r','abes0010r','abes0011r','abes0013r','abes0014r','abes0016r','abes0017r','abes0296a','abes1488a','abes1517a','abes1518a','abes1689a','abes1690a','abes1716a','abes1806a','abes1827a','abes1829a','abes1878a','abes1882a','abes1987a','abes2014a','abfi00349','abfi00351','abfr12020','abfr12031','abfr20049','abit1681a','abit1863a','abit1942a','abpt02019','abpt02021','abpt03096','abpt03102','abpt04002','abpt04006','aqs010710020','aqs060012005','aqs060430033','aqs060831011','aqs060831012','aqs060831013','aqs060831021','aqs060831026','aqs100051003','aqs191770006','aqs201070002','aqs201910002','aqs210610501','aqs220330013','aqs230052003','aqs250010002','aqs270177416',
        'aqs280450001','aqs291290001','aqs291860005','aqs300490004','aqs301110086','aqs360337003','aqs361010003','aqs371590021','aqs371630005','aqs380130002','aqs380570004','aqs380570102','aqs380570103','aqs380570104','aqs380570124','aqs390090004','aqs400719010','aqs400770441','aqs400979014','aqs401359015','aqs420010001','aqs420150011','aqs450190046','aqs461270001','aqs461270002','aqs470310004','aqs470750002','aqs470850020','aqs480290059','aqs481391044','aqs482030002','aqs482450101','aqs483091037','aqs483491051','aqs483670081','aqs484230007','aqs500070007','aqs530090013','aqs550270007','aqs560050456','aqs560136001','bft142','bvl130','eaij231','eaoc176','eaog198','dk0008r','es0014r','es0016r','es0017r','gb0013r','gb0014r','gb0031r','gb0044r','gb0053r','canaps030120','canaps054401','canaps055301','canaps060303','canaps062501','canaps063301','canaps063701','canaps065201','canaps091101','canaps091301','canaps091401','canaps091501','canaps091901','canaps092201','canaps092601','canaps093101','canaps093901','canaps102301','canaps105604','canaps129203']

a = Dataset('GLOBAL_SURFACE_%s_1970_2015_H_HDMS.nc'%(species))
time = a.variables['time'][:]
refs = a.groups.keys()
for i in range(len(refs)):
    if refs[i].lower() not in bad:
        if refs[i] not in good:   
            data = a.groups[refs[i]].variables[species.lower()][:]
            data[data < 0] = np.NaN
            if np.nanmean(data) < 2.0:
            #if np.nanmean(data) <2:
            #data[data < 0] = np.NaN
                print refs[i],a.groups[refs[i]].latitude,a.groups[refs[i]].longitude
            #plt.plot(time,data)
            #plt.show()
